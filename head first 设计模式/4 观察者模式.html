<html>
<head>
  <title>4 观察者模式</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600646 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="3372"/>
<h1>4 观察者模式</h1>

<div>
<span><div><div><span style="font-weight: bold;">观察者模式</span>：定义了对象之间的<span style="color: rgb(255, 0, 0);">一对多依赖</span>，这样一来 ，当一个对象改变状态时，它的所有依赖者都会收到通知并自动更新</div><div><br/></div><div><br/></div><div><img src="4 观察者模式_files/Image.png" type="image/png" data-filename="Image.png" width="1090"/></div><div><img src="4 观察者模式_files/Image [1].png" type="image/png" data-filename="Image.png" width="1010"/></div><div><br/></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(249, 38, 114); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">import</span> <span style="font-size: 14px; color: rgb(249, 38, 114); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">java.util.ArrayList</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">;</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><br/></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(249, 38, 114); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">public</span> <span style="font-size: 14px; color: rgb(249, 38, 114); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">interface</span> <span style="font-size: 14px; color: rgb(166, 226, 46); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px; text-decoration: underline;">Subject</span> <span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">{</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(249, 38, 114); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">    public</span> <span style="font-size: 14px; color: rgb(102, 217, 239); font-family: Consolas, &quot;Courier New&quot;, monospace; font-style: italic; line-height: 19px;">void</span> <span style="font-size: 14px; color: rgb(166, 226, 46); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">registerObserver</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">(</span><span style="font-size: 14px; color: rgb(102, 217, 239); font-family: Consolas, &quot;Courier New&quot;, monospace; font-style: italic; line-height: 19px;">Observer</span> <span style="font-size: 14px; color: rgb(253, 151, 31); font-family: Consolas, &quot;Courier New&quot;, monospace; font-style: italic; line-height: 19px;">o</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">);</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><br/></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(249, 38, 114); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">    public</span> <span style="font-size: 14px; color: rgb(102, 217, 239); font-family: Consolas, &quot;Courier New&quot;, monospace; font-style: italic; line-height: 19px;">void</span> <span style="font-size: 14px; color: rgb(166, 226, 46); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">removeObserver</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">(</span><span style="font-size: 14px; color: rgb(102, 217, 239); font-family: Consolas, &quot;Courier New&quot;, monospace; font-style: italic; line-height: 19px;">Observer</span> <span style="font-size: 14px; color: rgb(253, 151, 31); font-family: Consolas, &quot;Courier New&quot;, monospace; font-style: italic; line-height: 19px;">o</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">);</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><br/></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(249, 38, 114); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">    public</span> <span style="font-size: 14px; color: rgb(102, 217, 239); font-family: Consolas, &quot;Courier New&quot;, monospace; font-style: italic; line-height: 19px;">void</span> <span style="font-size: 14px; color: rgb(166, 226, 46); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">notifyObserver</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">();</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">}</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><br/></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(249, 38, 114); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">public</span> <span style="font-size: 14px; color: rgb(249, 38, 114); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">interface</span> <span style="font-size: 14px; color: rgb(166, 226, 46); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px; text-decoration: underline;">Observer</span> <span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">{</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(249, 38, 114); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">    public</span> <span style="font-size: 14px; color: rgb(102, 217, 239); font-family: Consolas, &quot;Courier New&quot;, monospace; font-style: italic; line-height: 19px;">void</span> <span style="font-size: 14px; color: rgb(166, 226, 46); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">update</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">(</span><span style="font-size: 14px; color: rgb(102, 217, 239); font-family: Consolas, &quot;Courier New&quot;, monospace; font-style: italic; line-height: 19px;">int</span> <span style="font-size: 14px; color: rgb(253, 151, 31); font-family: Consolas, &quot;Courier New&quot;, monospace; font-style: italic; line-height: 19px;">data</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">);</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">}</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><br/></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(249, 38, 114); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">public</span> <span style="font-size: 14px; color: rgb(249, 38, 114); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">interface</span> <span style="font-size: 14px; color: rgb(166, 226, 46); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px; text-decoration: underline;">DisplayElement</span> <span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">{</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(249, 38, 114); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">    public</span> <span style="font-size: 14px; color: rgb(102, 217, 239); font-family: Consolas, &quot;Courier New&quot;, monospace; font-style: italic; line-height: 19px;">void</span> <span style="font-size: 14px; color: rgb(166, 226, 46); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">display</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">();</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">}</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><br/></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(249, 38, 114); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">public</span> <span style="font-size: 14px; color: rgb(249, 38, 114); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">class</span> <span style="font-size: 14px; color: rgb(166, 226, 46); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px; text-decoration: underline;">SomeSubject</span> <span style="font-size: 14px; color: rgb(249, 38, 114); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">implements</span> <span style="font-size: 14px; color: rgb(166, 226, 46); font-family: Consolas, &quot;Courier New&quot;, monospace; font-style: italic; line-height: 19px; text-decoration: underline;">Subject</span> <span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">{</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(249, 38, 114); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">    private</span> <span style="font-size: 14px; color: rgb(102, 217, 239); font-family: Consolas, &quot;Courier New&quot;, monospace; font-style: italic; line-height: 19px;">ArrayList</span> <span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">observers</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">;</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(249, 38, 114); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">    private</span> <span style="font-size: 14px; color: rgb(102, 217, 239); font-family: Consolas, &quot;Courier New&quot;, monospace; font-style: italic; line-height: 19px;">int</span> <span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">data</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">;</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><br/></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(249, 38, 114); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">    public</span> <span style="font-size: 14px; color: rgb(166, 226, 46); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">SomeSubject</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">() {</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">        observers</span> <span style="font-size: 14px; color: rgb(249, 38, 114); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">=</span> <span style="font-size: 14px; color: rgb(249, 38, 114); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">new</span> <span style="font-size: 14px; color: rgb(102, 217, 239); font-family: Consolas, &quot;Courier New&quot;, monospace; font-style: italic; line-height: 19px;">ArrayList</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">&lt;&gt;();</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">    }</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><br/></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(249, 38, 114); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">    public</span> <span style="font-size: 14px; color: rgb(102, 217, 239); font-family: Consolas, &quot;Courier New&quot;, monospace; font-style: italic; line-height: 19px;">void</span> <span style="font-size: 14px; color: rgb(166, 226, 46); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">registerObserver</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">(</span><span style="font-size: 14px; color: rgb(102, 217, 239); font-family: Consolas, &quot;Courier New&quot;, monospace; font-style: italic; line-height: 19px;">Observer</span> <span style="font-size: 14px; color: rgb(253, 151, 31); font-family: Consolas, &quot;Courier New&quot;, monospace; font-style: italic; line-height: 19px;">o</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">) {</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">            observers</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">.</span><span style="font-size: 14px; color: rgb(166, 226, 46); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">add</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">(o);</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">    }</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><br/></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(249, 38, 114); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">    public</span> <span style="font-size: 14px; color: rgb(102, 217, 239); font-family: Consolas, &quot;Courier New&quot;, monospace; font-style: italic; line-height: 19px;">void</span> <span style="font-size: 14px; color: rgb(166, 226, 46); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">removeObserver</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">(</span><span style="font-size: 14px; color: rgb(102, 217, 239); font-family: Consolas, &quot;Courier New&quot;, monospace; font-style: italic; line-height: 19px;">Observer</span> <span style="font-size: 14px; color: rgb(253, 151, 31); font-family: Consolas, &quot;Courier New&quot;, monospace; font-style: italic; line-height: 19px;">o</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">) {</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(102, 217, 239); font-family: Consolas, &quot;Courier New&quot;, monospace; font-style: italic; line-height: 19px;">        int</span> <span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">i</span> <span style="font-size: 14px; color: rgb(249, 38, 114); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">=</span> <span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">observers</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">.</span><span style="font-size: 14px; color: rgb(166, 226, 46); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">indexOf</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">(o);</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(249, 38, 114); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">        if</span> <span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">(i</span> <span style="font-size: 14px; color: rgb(249, 38, 114); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">&gt;=</span> <span style="font-size: 14px; color: rgb(174, 129, 255); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">0</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">) {</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">            observers</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">.</span><span style="font-size: 14px; color: rgb(166, 226, 46); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">remove</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">(i);</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">        }</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">    }</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><br/></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(249, 38, 114); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">    public</span> <span style="font-size: 14px; color: rgb(102, 217, 239); font-family: Consolas, &quot;Courier New&quot;, monospace; font-style: italic; line-height: 19px;">void</span> <span style="font-size: 14px; color: rgb(166, 226, 46); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">notifyObserver</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">() {</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(249, 38, 114); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">        for</span> <span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">(</span><span style="font-size: 14px; color: rgb(102, 217, 239); font-family: Consolas, &quot;Courier New&quot;, monospace; font-style: italic; line-height: 19px;">int</span> <span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">i</span> <span style="font-size: 14px; color: rgb(249, 38, 114); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">=</span> <span style="font-size: 14px; color: rgb(174, 129, 255); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">0</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">; i</span> <span style="font-size: 14px; color: rgb(249, 38, 114); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">&lt;</span> <span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">observers</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">.</span><span style="font-size: 14px; color: rgb(166, 226, 46); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">size</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">(); i</span><span style="font-size: 14px; color: rgb(249, 38, 114); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">++</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">) {</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(102, 217, 239); font-family: Consolas, &quot;Courier New&quot;, monospace; font-style: italic; line-height: 19px;">            Observer</span> <span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">observer</span> <span style="font-size: 14px; color: rgb(249, 38, 114); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">=</span> <span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">(Observer)</span> <span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">observers</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">.</span><span style="font-size: 14px; color: rgb(166, 226, 46); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">get</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">(i);</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">            observer</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">.</span><span style="font-size: 14px; color: rgb(166, 226, 46); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">update</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">(data);</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">        }</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">    }</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><br/></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(249, 38, 114); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">    public</span> <span style="font-size: 14px; color: rgb(102, 217, 239); font-family: Consolas, &quot;Courier New&quot;, monospace; font-style: italic; line-height: 19px;">void</span> <span style="font-size: 14px; color: rgb(166, 226, 46); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">someOption</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">() {</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(166, 226, 46); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">        notifyObserver</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">();</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">    }</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">}</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><br/></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(249, 38, 114); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">public</span> <span style="font-size: 14px; color: rgb(249, 38, 114); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">class</span> <span style="font-size: 14px; color: rgb(166, 226, 46); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px; text-decoration: underline;">someObserver</span> <span style="font-size: 14px; color: rgb(249, 38, 114); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">implements</span> <span style="font-size: 14px; color: rgb(166, 226, 46); font-family: Consolas, &quot;Courier New&quot;, monospace; font-style: italic; line-height: 19px; text-decoration: underline;">Observer</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">,</span> <span style="font-size: 14px; color: rgb(166, 226, 46); font-family: Consolas, &quot;Courier New&quot;, monospace; font-style: italic; line-height: 19px; text-decoration: underline;">DisplayElement</span> <span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">{</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(249, 38, 114); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">    private</span> <span style="font-size: 14px; color: rgb(102, 217, 239); font-family: Consolas, &quot;Courier New&quot;, monospace; font-style: italic; line-height: 19px;">int</span> <span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">data</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">;</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(249, 38, 114); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">    private</span> <span style="font-size: 14px; color: rgb(102, 217, 239); font-family: Consolas, &quot;Courier New&quot;, monospace; font-style: italic; line-height: 19px;">Subject</span> <span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">s</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">;</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(249, 38, 114); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">    public</span> <span style="font-size: 14px; color: rgb(166, 226, 46); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">someObserver</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">(</span><span style="font-size: 14px; color: rgb(102, 217, 239); font-family: Consolas, &quot;Courier New&quot;, monospace; font-style: italic; line-height: 19px;">Subject</span> <span style="font-size: 14px; color: rgb(253, 151, 31); font-family: Consolas, &quot;Courier New&quot;, monospace; font-style: italic; line-height: 19px;">s</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">) {</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(117, 113, 94); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">        // 注意这一点：持有了对</span><span style="font-size: 14px; color: rgb(102, 217, 239); font-family: Consolas, &quot;Courier New&quot;, monospace; font-style: italic; line-height: 19px;">Subject</span><span style="font-size: 14px; color: rgb(117, 113, 94); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">的引用（非必要），目的是方便以后取消注册</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(253, 151, 31); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">        this</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">.</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">s</span> <span style="font-size: 14px; color: rgb(249, 38, 114); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">=</span> <span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">s;</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(117, 113, 94); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">        // 构建时即注册，当然也可以灵活注册</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">        s</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">.</span><span style="font-size: 14px; color: rgb(166, 226, 46); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">registerObserver</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">(</span><span style="font-size: 14px; color: rgb(253, 151, 31); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">this</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">);</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">    }</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(249, 38, 114); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">    public</span> <span style="font-size: 14px; color: rgb(102, 217, 239); font-family: Consolas, &quot;Courier New&quot;, monospace; font-style: italic; line-height: 19px;">void</span> <span style="font-size: 14px; color: rgb(166, 226, 46); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">update</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">(</span><span style="font-size: 14px; color: rgb(102, 217, 239); font-family: Consolas, &quot;Courier New&quot;, monospace; font-style: italic; line-height: 19px;">int</span> <span style="font-size: 14px; color: rgb(253, 151, 31); font-family: Consolas, &quot;Courier New&quot;, monospace; font-style: italic; line-height: 19px;">data</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">) {</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(253, 151, 31); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">        this</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">.</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">data</span> <span style="font-size: 14px; color: rgb(249, 38, 114); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">=</span> <span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">data;</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(166, 226, 46); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">        display</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">();</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">    }</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(249, 38, 114); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">    public</span> <span style="font-size: 14px; color: rgb(102, 217, 239); font-family: Consolas, &quot;Courier New&quot;, monospace; font-style: italic; line-height: 19px;">void</span> <span style="font-size: 14px; color: rgb(166, 226, 46); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">display</span><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">() {</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(117, 113, 94); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">        // display</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">    }</span></div><div style="background-color: rgb(39, 40, 34); font-size: 14px; white-space: pre;"><span style="font-size: 14px; color: rgb(248, 248, 242); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;">}</span></div><div><br/></div><div><br/></div><hr/><div><br/></div><div>java内置观察者</div><ul><li><div>setChanged()可以标记状态已改变（用途如节流、防抖）</div></li><li><div>内置实现了notifyObserver()的两种重载形式来支持pull/push模式</div></li><li><div>推模式：直接提供数据对象</div></li><li><div>拉模式：观察者从可观察对象获取数据</div></li><li><div>有一定的问题，比如说：java的observable是类而不是接口、setChanged是protected（不利于组合）</div></li></ul><div><br/></div><div><br/></div><div><img src="4 观察者模式_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div><img src="4 观察者模式_files/Image [3].png" type="image/png" data-filename="Image.png"/></div><div><img src="4 观察者模式_files/Image [4].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></div><div><br/></div></span>
</div></body></html> 